view: product_wise_profit {
  derived_table: {
    sql: SELECT
        'PR151' AS product_id, 20 AS margin, 12198000 AS total_sales
      UNION ALL
      SELECT
        'PR139' AS product_id, 25 AS margin, 10237500 AS total_sales
      UNION ALL
      SELECT
        'PR144' AS product_id, 20 AS margin, 3840000 AS total_sales
      UNION ALL
      SELECT
        'PR184' AS product_id, 5 AS margin, 51502.5 AS total_sales
      UNION ALL
      SELECT
        'PR117' AS product_id, 10 AS margin, 280500 AS total_sales
      UNION ALL
      SELECT
        'PR207' AS product_id, 20 AS margin, 6900000 AS total_sales
      UNION ALL
      SELECT
        'PR190' AS product_id, 10 AS margin, 633600 AS total_sales
      UNION ALL
      SELECT
        'PR204' AS product_id, 20 AS margin, 10476000 AS total_sales
      UNION ALL
      SELECT
        'PR201' AS product_id, 20 AS margin, 3870000 AS total_sales
      UNION ALL
      SELECT
        'PR147' AS product_id, 20 AS margin, 15000000 AS total_sales
      UNION ALL
      SELECT
        'PR106' AS product_id, 15 AS margin, 4588500 AS total_sales
      UNION ALL
      SELECT
        'PR210' AS product_id, 20 AS margin, 19080000 AS total_sales
      UNION ALL
      SELECT
        'PR174' AS product_id, 25 AS margin, 2118750 AS total_sales
      UNION ALL
      SELECT
        'PR108' AS product_id, 15 AS margin, 5796000 AS total_sales
      UNION ALL
      SELECT
        'PR166' AS product_id, 10 AS margin, 990000 AS total_sales
      UNION ALL
      SELECT
        'PR198' AS product_id, 10 AS margin, 886600 AS total_sales
      UNION ALL
      SELECT
        'PR165' AS product_id, 10 AS margin, 925650 AS total_sales
      UNION ALL
      SELECT
        'PR196' AS product_id, 10 AS margin, 569250 AS total_sales
      UNION ALL
      SELECT
        'PR153' AS product_id, 20 AS margin, 4867200 AS total_sales
      UNION ALL
      SELECT
        'PR171' AS product_id, 25 AS margin, 2775000 AS total_sales
      UNION ALL
      SELECT
        'PR159' AS product_id, 20 AS margin, 13992000 AS total_sales
      UNION ALL
      SELECT
        'PR162' AS product_id, 10 AS margin, 1284800 AS total_sales
      UNION ALL
      SELECT
        'PR193' AS product_id, 10 AS margin, 702240 AS total_sales
      UNION ALL
      SELECT
        'PR142' AS product_id, 25 AS margin, 5347500 AS total_sales
      UNION ALL
      SELECT
        'PR187' AS product_id, 5 AS margin, 71662.5 AS total_sales
      UNION ALL
      SELECT
        'PR105' AS product_id, 15 AS margin, 2884200 AS total_sales
      UNION ALL
      SELECT
        'PR114' AS product_id, 10 AS margin, 360250 AS total_sales
      UNION ALL
      SELECT
        'PR102' AS product_id, 15 AS margin, 3277500 AS total_sales
      UNION ALL
      SELECT
        'PR192' AS product_id, 10 AS margin, 576400 AS total_sales
      UNION ALL
      SELECT
        'PR195' AS product_id, 10 AS margin, 950400 AS total_sales
      UNION ALL
      SELECT
        'PR209' AS product_id, 20 AS margin, 10920000 AS total_sales
      UNION ALL
      SELECT
        'PR109' AS product_id, 15 AS margin, 4548250 AS total_sales
      UNION ALL
      SELECT
        'PR103' AS product_id, 15 AS margin, 2530000 AS total_sales
      UNION ALL
      SELECT
        'PR173' AS product_id, 25 AS margin, 1980000 AS total_sales
      UNION ALL
      SELECT
        'PR179' AS product_id, 25 AS margin, 3478750 AS total_sales
      UNION ALL
      SELECT
        'PR133' AS product_id, 25 AS margin, 5450000 AS total_sales
      UNION ALL
      SELECT
        'PR150' AS product_id, 20 AS margin, 8910000 AS total_sales
      UNION ALL
      SELECT
        'PR136' AS product_id, 25 AS margin, 5162500 AS total_sales
      UNION ALL
      SELECT
        'PR163' AS product_id, 10 AS margin, 1716000 AS total_sales
      UNION ALL
      SELECT
        'PR125' AS product_id, 15 AS margin, 1956725 AS total_sales
      UNION ALL
      SELECT
        'PR135' AS product_id, 25 AS margin, 8260000 AS total_sales
      UNION ALL
      SELECT
        'PR132' AS product_id, 25 AS margin, 3375000 AS total_sales
      UNION ALL
      SELECT
        'PR199' AS product_id, 20 AS margin, 1219200 AS total_sales
      UNION ALL
      SELECT
        'PR155' AS product_id, 20 AS margin, 12528000 AS total_sales
      UNION ALL
      SELECT
        'PR123' AS product_id, 15 AS margin, 796950 AS total_sales
      UNION ALL
      SELECT
        'PR152' AS product_id, 20 AS margin, 3091200 AS total_sales
      UNION ALL
      SELECT
        'PR126' AS product_id, 15 AS margin, 1138500 AS total_sales
      UNION ALL
      SELECT
        'PR168' AS product_id, 25 AS margin, 971250 AS total_sales
      UNION ALL
      SELECT
        'PR160' AS product_id, 10 AS margin, 405900 AS total_sales
      UNION ALL
      SELECT
        'PR156' AS product_id, 20 AS margin, 4536000 AS total_sales
      UNION ALL
      SELECT
        'PR128' AS product_id, 15 AS margin, 2961250 AS total_sales
      UNION ALL
      SELECT
        'PR138' AS product_id, 25 AS margin, 7425000 AS total_sales
      UNION ALL
      SELECT
        'PR110' AS product_id, 15 AS margin, 4945000 AS total_sales
      UNION ALL
      SELECT
        'PR181' AS product_id, 5 AS margin, 33862.5 AS total_sales
      UNION ALL
      SELECT
        'PR200' AS product_id, 20 AS margin, 1116000 AS total_sales
      UNION ALL
      SELECT
        'PR158' AS product_id, 20 AS margin, 10752000 AS total_sales
      UNION ALL
      SELECT
        'PR194' AS product_id, 10 AS margin, 651420 AS total_sales
      UNION ALL
      SELECT
        'PR197' AS product_id, 10 AS margin, 574200 AS total_sales
      UNION ALL
      SELECT
        'PR161' AS product_id, 10 AS margin, 823900 AS total_sales
      UNION ALL
      SELECT
        'PR175' AS product_id, 25 AS margin, 4312500 AS total_sales
      UNION ALL
      SELECT
        'PR116' AS product_id, 10 AS margin, 389400 AS total_sales
      UNION ALL
      SELECT
        'PR118' AS product_id, 10 AS margin, 339900 AS total_sales
      UNION ALL
      SELECT
        'PR183' AS product_id, 5 AS margin, 88935 AS total_sales
      UNION ALL
      SELECT
        'PR172' AS product_id, 25 AS margin, 1361250 AS total_sales
      UNION ALL
      SELECT
        'PR205' AS product_id, 20 AS margin, 4020000 AS total_sales
      UNION ALL
      SELECT
        'PR202' AS product_id, 20 AS margin, 3998400 AS total_sales
      UNION ALL
      SELECT
        'PR120' AS product_id, 10 AS margin, 343200 AS total_sales
      UNION ALL
      SELECT
        'PR129' AS product_id, 15 AS margin, 1219000 AS total_sales
      UNION ALL
      SELECT
        'PR203' AS product_id, 20 AS margin, 4920000 AS total_sales
      UNION ALL
      SELECT
        'PR101' AS product_id, 15 AS margin, 2415000 AS total_sales
      UNION ALL
      SELECT
        'PR169' AS product_id, 25 AS margin, 1075000 AS total_sales
      UNION ALL
      SELECT
        'PR170' AS product_id, 25 AS margin, 2343750 AS total_sales
      UNION ALL
      SELECT
        'PR141' AS product_id, 25 AS margin, 4578750 AS total_sales
      UNION ALL
      SELECT
        'PR131' AS product_id, 15 AS margin, 3735200 AS total_sales
      UNION ALL
      SELECT
        'PR206' AS product_id, 20 AS margin, 4968000 AS total_sales
      UNION ALL
      SELECT
        'PR189' AS product_id, 10 AS margin, 462000 AS total_sales
      UNION ALL
      SELECT
        'PR180' AS product_id, 5 AS margin, 65100 AS total_sales
      UNION ALL
      SELECT
        'PR208' AS product_id, 20 AS margin, 7920000 AS total_sales
      UNION ALL
      SELECT
        'PR149' AS product_id, 20 AS margin, 4656000 AS total_sales
      UNION ALL
      SELECT
        'PR176' AS product_id, 25 AS margin, 796875 AS total_sales
      UNION ALL
      SELECT
        'PR115' AS product_id, 10 AS margin, 277970 AS total_sales
      UNION ALL
      SELECT
        'PR112' AS product_id, 10 AS margin, 481800 AS total_sales
      UNION ALL
      SELECT
        'PR122' AS product_id, 10 AS margin, 778800 AS total_sales
      UNION ALL
      SELECT
        'PR178' AS product_id, 25 AS margin, 1440000 AS total_sales
      UNION ALL
      SELECT
        'PR182' AS product_id, 5 AS margin, 55755 AS total_sales
      UNION ALL
      SELECT
        'PR111' AS product_id, 10 AS margin, 246400 AS total_sales
      UNION ALL
      SELECT
        'PR185' AS product_id, 5 AS margin, 19551 AS total_sales
      UNION ALL
      SELECT
        'PR188' AS product_id, 10 AS margin, 385000 AS total_sales
      UNION ALL
      SELECT
        'PR127' AS product_id, 15 AS margin, 1718100 AS total_sales
      UNION ALL
      SELECT
        'PR143' AS product_id, 25 AS margin, 8156250 AS total_sales
      UNION ALL
      SELECT
        'PR145' AS product_id, 20 AS margin, 4410000 AS total_sales
      UNION ALL
      SELECT
        'PR157' AS product_id, 20 AS margin, 6588000 AS total_sales
      UNION ALL
      SELECT
        'PR124' AS product_id, 15 AS margin, 1707750 AS total_sales
      UNION ALL
      SELECT
        'PR134' AS product_id, 25 AS margin, 6693750 AS total_sales
      UNION ALL
      SELECT
        'PR191' AS product_id, 10 AS margin, 1000450 AS total_sales
      UNION ALL
      SELECT
        'PR121' AS product_id, 10 AS margin, 665500 AS total_sales
      UNION ALL
      SELECT
        'PR154' AS product_id, 20 AS margin, 7290000 AS total_sales
      UNION ALL
      SELECT
        'PR107' AS product_id, 15 AS margin, 2829000 AS total_sales
      UNION ALL
      SELECT
        'PR146' AS product_id, 20 AS margin, 5400000 AS total_sales
      UNION ALL
      SELECT
        'PR177' AS product_id, 25 AS margin, 1068750 AS total_sales
      UNION ALL
      SELECT
        'PR137' AS product_id, 25 AS margin, 7143750 AS total_sales
      UNION ALL
      SELECT
        'PR148' AS product_id, 20 AS margin, 2772000 AS total_sales
      UNION ALL
      SELECT
        'PR140' AS product_id, 25 AS margin, 4350000 AS total_sales
      UNION ALL
      SELECT
        'PR113' AS product_id, 10 AS margin, 605000 AS total_sales
      UNION ALL
      SELECT
        'PR130' AS product_id, 15 AS margin, 1845750 AS total_sales
      UNION ALL
      SELECT
        'PR119' AS product_id, 10 AS margin, 641300 AS total_sales
      UNION ALL
      SELECT
        'PR186' AS product_id, 5 AS margin, 45885 AS total_sales
      UNION ALL
      SELECT
        'PR167' AS product_id, 10 AS margin, 2244000 AS total_sales
      UNION ALL
      SELECT
        'PR104' AS product_id, 15 AS margin, 3726000 AS total_sales
      UNION ALL
      SELECT
        'PR164' AS product_id, 10 AS margin, 454300 AS total_sales
       ;;
  }

  measure: count {
    type: count
    drill_fields: [detail*]
  }

  dimension: product_id {
    type: string
    sql: ${TABLE}.product_id ;;
  }

  dimension: margin {
    type: number
    sql: ${TABLE}.margin ;;
  }

  measure: total_sales {
    type: sum
    sql: ${TABLE}.total_sales ;;
  }

  set: detail {
    fields: [product_id, margin, total_sales]
  }
}
