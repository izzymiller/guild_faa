view: period_over_period {
  derived_table: {
    sql: SELECT
        CAST('2021-09-01' AS DATE) AS date, 329123 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-02' AS DATE) AS date, 57598 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-03' AS DATE) AS date, 413969 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-04' AS DATE) AS date, 249862 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-05' AS DATE) AS date, 120437 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-06' AS DATE) AS date, 193246 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-07' AS DATE) AS date, 417505 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-08' AS DATE) AS date, 442861 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-09' AS DATE) AS date, 217562 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-10' AS DATE) AS date, 81429 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-11' AS DATE) AS date, 281730 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-12' AS DATE) AS date, 239324 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-13' AS DATE) AS date, 153238 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-14' AS DATE) AS date, 145768 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-15' AS DATE) AS date, 138021 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-16' AS DATE) AS date, 129511 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-17' AS DATE) AS date, 388025 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-18' AS DATE) AS date, 252383 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-19' AS DATE) AS date, 275086 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-20' AS DATE) AS date, 466343 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-21' AS DATE) AS date, 44377 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-22' AS DATE) AS date, 116669 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-23' AS DATE) AS date, 379059 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-24' AS DATE) AS date, 35109 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-25' AS DATE) AS date, 198975 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-26' AS DATE) AS date, 388650 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-27' AS DATE) AS date, 186407 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-28' AS DATE) AS date, 310047 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-29' AS DATE) AS date, 15985 AS sales
      UNION ALL
      SELECT
        CAST('2021-09-30' AS DATE) AS date, 41620 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-01' AS DATE) AS date, 468107 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-02' AS DATE) AS date, 291970 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-03' AS DATE) AS date, 496616 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-04' AS DATE) AS date, 325989 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-05' AS DATE) AS date, 74819 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-06' AS DATE) AS date, 316295 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-07' AS DATE) AS date, 439547 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-08' AS DATE) AS date, 337490 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-09' AS DATE) AS date, 278950 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-10' AS DATE) AS date, 423387 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-11' AS DATE) AS date, 97201 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-12' AS DATE) AS date, 220071 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-13' AS DATE) AS date, 449412 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-14' AS DATE) AS date, 408488 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-15' AS DATE) AS date, 295472 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-16' AS DATE) AS date, 493323 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-17' AS DATE) AS date, 103635 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-18' AS DATE) AS date, 133107 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-19' AS DATE) AS date, 105566 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-20' AS DATE) AS date, 315174 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-21' AS DATE) AS date, 145405 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-22' AS DATE) AS date, 296809 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-23' AS DATE) AS date, 316522 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-24' AS DATE) AS date, 45639 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-25' AS DATE) AS date, 66536 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-26' AS DATE) AS date, 97070 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-27' AS DATE) AS date, 366076 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-28' AS DATE) AS date, 253272 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-29' AS DATE) AS date, 306923 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-30' AS DATE) AS date, 42847 AS sales
      UNION ALL
      SELECT
        CAST('2021-10-31' AS DATE) AS date, 452187 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-01' AS DATE) AS date, 335520 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-02' AS DATE) AS date, 10471 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-03' AS DATE) AS date, 120328 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-04' AS DATE) AS date, 59695 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-05' AS DATE) AS date, 165395 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-06' AS DATE) AS date, 143531 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-07' AS DATE) AS date, 441243 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-08' AS DATE) AS date, 390408 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-09' AS DATE) AS date, 485933 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-10' AS DATE) AS date, 295008 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-11' AS DATE) AS date, 325266 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-12' AS DATE) AS date, 370816 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-13' AS DATE) AS date, 246907 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-14' AS DATE) AS date, 84911 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-15' AS DATE) AS date, 39026 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-16' AS DATE) AS date, 466235 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-17' AS DATE) AS date, 218783 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-18' AS DATE) AS date, 294491 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-19' AS DATE) AS date, 356078 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-20' AS DATE) AS date, 105236 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-21' AS DATE) AS date, 335438 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-22' AS DATE) AS date, 94029 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-23' AS DATE) AS date, 380218 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-24' AS DATE) AS date, 154721 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-25' AS DATE) AS date, 133775 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-26' AS DATE) AS date, 177544 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-27' AS DATE) AS date, 293073 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-28' AS DATE) AS date, 68463 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-29' AS DATE) AS date, 298833 AS sales
      UNION ALL
      SELECT
        CAST('2021-11-30' AS DATE) AS date, 254630 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-01' AS DATE) AS date, 357392 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-02' AS DATE) AS date, 21143 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-03' AS DATE) AS date, 340205 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-04' AS DATE) AS date, 440015 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-05' AS DATE) AS date, 134220 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-06' AS DATE) AS date, 101541 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-07' AS DATE) AS date, 468020 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-08' AS DATE) AS date, 84963 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-09' AS DATE) AS date, 64025 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-10' AS DATE) AS date, 103326 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-11' AS DATE) AS date, 110365 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-12' AS DATE) AS date, 208234 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-13' AS DATE) AS date, 54475 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-14' AS DATE) AS date, 451237 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-15' AS DATE) AS date, 398440 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-16' AS DATE) AS date, 54664 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-17' AS DATE) AS date, 490851 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-18' AS DATE) AS date, 40747 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-19' AS DATE) AS date, 439024 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-20' AS DATE) AS date, 324969 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-21' AS DATE) AS date, 414571 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-22' AS DATE) AS date, 201085 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-23' AS DATE) AS date, 68921 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-24' AS DATE) AS date, 141721 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-25' AS DATE) AS date, 47782 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-26' AS DATE) AS date, 102721 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-27' AS DATE) AS date, 442558 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-28' AS DATE) AS date, 395770 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-29' AS DATE) AS date, 279701 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-30' AS DATE) AS date, 151181 AS sales
      UNION ALL
      SELECT
        CAST('2021-12-31' AS DATE) AS date, 342593 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-01' AS DATE) AS date, 125762 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-02' AS DATE) AS date, 463983 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-03' AS DATE) AS date, 275323 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-04' AS DATE) AS date, 357075 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-05' AS DATE) AS date, 27773 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-06' AS DATE) AS date, 130272 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-07' AS DATE) AS date, 278328 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-08' AS DATE) AS date, 131344 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-09' AS DATE) AS date, 424965 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-10' AS DATE) AS date, 314084 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-11' AS DATE) AS date, 128084 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-12' AS DATE) AS date, 88442 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-13' AS DATE) AS date, 320568 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-14' AS DATE) AS date, 381051 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-15' AS DATE) AS date, 418815 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-16' AS DATE) AS date, 458745 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-17' AS DATE) AS date, 172604 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-18' AS DATE) AS date, 119811 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-19' AS DATE) AS date, 74664 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-20' AS DATE) AS date, 396460 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-21' AS DATE) AS date, 147320 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-22' AS DATE) AS date, 145277 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-23' AS DATE) AS date, 261806 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-24' AS DATE) AS date, 218097 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-25' AS DATE) AS date, 160161 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-26' AS DATE) AS date, 277495 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-27' AS DATE) AS date, 174349 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-28' AS DATE) AS date, 164658 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-29' AS DATE) AS date, 83038 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-30' AS DATE) AS date, 228915 AS sales
      UNION ALL
      SELECT
        CAST('2022-01-31' AS DATE) AS date, 46891 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-01' AS DATE) AS date, 223526 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-02' AS DATE) AS date, 339221 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-03' AS DATE) AS date, 350609 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-04' AS DATE) AS date, 124584 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-05' AS DATE) AS date, 153489 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-06' AS DATE) AS date, 292396 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-07' AS DATE) AS date, 468448 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-08' AS DATE) AS date, 356525 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-09' AS DATE) AS date, 240127 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-10' AS DATE) AS date, 223137 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-11' AS DATE) AS date, 112920 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-12' AS DATE) AS date, 389842 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-13' AS DATE) AS date, 333947 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-14' AS DATE) AS date, 14095 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-15' AS DATE) AS date, 404023 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-16' AS DATE) AS date, 243439 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-17' AS DATE) AS date, 430103 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-18' AS DATE) AS date, 259816 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-19' AS DATE) AS date, 341446 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-20' AS DATE) AS date, 352641 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-21' AS DATE) AS date, 473605 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-22' AS DATE) AS date, 101051 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-23' AS DATE) AS date, 148156 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-24' AS DATE) AS date, 379867 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-25' AS DATE) AS date, 69694 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-26' AS DATE) AS date, 214426 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-27' AS DATE) AS date, 289261 AS sales
      UNION ALL
      SELECT
        CAST('2022-02-28' AS DATE) AS date, 56205 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-01' AS DATE) AS date, 452959 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-02' AS DATE) AS date, 419972 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-03' AS DATE) AS date, 361856 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-04' AS DATE) AS date, 256704 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-05' AS DATE) AS date, 476082 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-06' AS DATE) AS date, 30967 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-07' AS DATE) AS date, 123128 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-08' AS DATE) AS date, 70155 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-09' AS DATE) AS date, 146761 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-10' AS DATE) AS date, 151751 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-11' AS DATE) AS date, 295783 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-12' AS DATE) AS date, 115410 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-13' AS DATE) AS date, 292881 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-14' AS DATE) AS date, 333611 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-15' AS DATE) AS date, 304558 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-16' AS DATE) AS date, 422046 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-17' AS DATE) AS date, 273912 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-18' AS DATE) AS date, 28037 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-19' AS DATE) AS date, 263513 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-20' AS DATE) AS date, 83562 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-21' AS DATE) AS date, 219526 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-22' AS DATE) AS date, 98184 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-23' AS DATE) AS date, 462167 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-24' AS DATE) AS date, 135648 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-25' AS DATE) AS date, 87521 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-26' AS DATE) AS date, 370199 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-27' AS DATE) AS date, 34024 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-28' AS DATE) AS date, 135172 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-29' AS DATE) AS date, 109941 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-30' AS DATE) AS date, 430570 AS sales
      UNION ALL
      SELECT
        CAST('2022-03-31' AS DATE) AS date, 241259 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-01' AS DATE) AS date, 57950 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-02' AS DATE) AS date, 439912 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-03' AS DATE) AS date, 336419 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-04' AS DATE) AS date, 10193 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-05' AS DATE) AS date, 189259 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-06' AS DATE) AS date, 253387 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-07' AS DATE) AS date, 108656 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-08' AS DATE) AS date, 287373 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-09' AS DATE) AS date, 312861 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-10' AS DATE) AS date, 466833 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-11' AS DATE) AS date, 60480 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-12' AS DATE) AS date, 53024 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-13' AS DATE) AS date, 32760 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-14' AS DATE) AS date, 329085 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-15' AS DATE) AS date, 223374 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-16' AS DATE) AS date, 211108 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-17' AS DATE) AS date, 132876 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-18' AS DATE) AS date, 67780 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-19' AS DATE) AS date, 13021 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-20' AS DATE) AS date, 441590 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-21' AS DATE) AS date, 477789 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-22' AS DATE) AS date, 321502 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-23' AS DATE) AS date, 334504 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-24' AS DATE) AS date, 177075 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-25' AS DATE) AS date, 370308 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-26' AS DATE) AS date, 329595 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-27' AS DATE) AS date, 213627 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-28' AS DATE) AS date, 411874 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-29' AS DATE) AS date, 274104 AS sales
      UNION ALL
      SELECT
        CAST('2022-04-30' AS DATE) AS date, 434013 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-01' AS DATE) AS date, 51600 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-02' AS DATE) AS date, 326154 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-03' AS DATE) AS date, 319396 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-04' AS DATE) AS date, 435778 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-05' AS DATE) AS date, 157333 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-06' AS DATE) AS date, 150743 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-07' AS DATE) AS date, 303071 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-08' AS DATE) AS date, 331764 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-09' AS DATE) AS date, 431543 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-10' AS DATE) AS date, 453798 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-11' AS DATE) AS date, 156030 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-12' AS DATE) AS date, 102611 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-13' AS DATE) AS date, 232736 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-14' AS DATE) AS date, 309401 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-15' AS DATE) AS date, 35109 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-16' AS DATE) AS date, 442934 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-17' AS DATE) AS date, 84654 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-18' AS DATE) AS date, 13830 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-19' AS DATE) AS date, 36001 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-20' AS DATE) AS date, 178940 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-21' AS DATE) AS date, 197459 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-22' AS DATE) AS date, 343105 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-23' AS DATE) AS date, 287305 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-24' AS DATE) AS date, 240803 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-25' AS DATE) AS date, 422462 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-26' AS DATE) AS date, 311146 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-27' AS DATE) AS date, 496679 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-28' AS DATE) AS date, 346806 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-29' AS DATE) AS date, 152886 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-30' AS DATE) AS date, 456198 AS sales
      UNION ALL
      SELECT
        CAST('2022-05-31' AS DATE) AS date, 266630 AS sales
       ;;
  }

  measure: count {
    type: count
    drill_fields: [detail*]
  }

  dimension: date {
    type: date
    datatype: date
    sql: ${TABLE}.date ;;
  }

  dimension: sales {
    type: number
    sql: ${TABLE}.sales ;;
  }
  dimension_group: created{

  type: time

  timeframes: [time, date, week, year]

  sql: ${TABLE}.date;;

}
  dimension: is_before_mtd {
  type: yesno
  sql:
   (EXTRACT(DAY FROM ${created_time}) < EXTRACT(DAY FROM CURRENT_TIMESTAMP)
  OR ( EXTRACT(DAY FROM ${created_time}) = EXTRACT(DAY FROM CURRENT_TIMESTAMP)
  AND EXTRACT(HOUR FROM ${created_time}) < EXTRACT(HOUR FROM CURRENT_TIMESTAMP) )
  OR ( EXTRACT(DAY FROM ${created_time}) = EXTRACT(DAY FROM CURRENT_TIMESTAMP)
  AND EXTRACT(HOUR FROM ${created_time}) <= EXTRACT(HOUR FROM CURRENT_TIMESTAMP)
  AND EXTRACT(MINUTE FROM ${created_time}) < EXTRACT(MINUTE FROM CURRENT_TIMESTAMP) ) );;

}

parameter: period {
  label: "Timeframe"
  view_label: "Period Over Period"
  type: unquoted
  allowed_value: {
  label: "Week to Date"
  value: "week"
  }
  allowed_value: {
  label: "Month to Date"
  value: "Month"
  }
  allowed_value: {
    label: "Quarter to Date"
    value: "Quarter"
  }
  allowed_value: {
    label: "Year to Date"
    value: "Year"
  }
  default_value: "Period"
}

#To det start date we need to get either first day of the year,month or quarter
dimension: first_date_in_period {
view_label: "Period Over Period"
datatype: date
type: date
hidden: no
sql: DATE_TRUNC(CURRENT_DATE(), {% parameter period%}) ;;
}

#Now get the total number of days in the period
dimension: days_in_period {
view_label: "Period Over Period"
type: number
hidden: no
sql:DATE_DIFF(CURRENT_DATE(),${first_date_in_period}, DAY)  ;;
}

#Now get the first date in the prior period
  dimension: first_date_in_prior_period {
    view_label: "Period Over Period"
    datatype: date
    type: date
    hidden: no
    sql: DATE_TRUNC(DATE_ADD(CURRENT_DATE(), INTERVAL -1{% parameter period %}),{% parameter period %}) ;;
  }

#Now get the last date in the prior period
dimension: last_date_in_prior_period{
datatype: date
view_label: "Period Over Period"
type: date
hidden: no
sql: DATE_ADD(${first_date_in_prior_period},INTERVAL ${days_in_period} DAY) ;;
}

#Now figure out which period each date belongs in
dimension: period_selected{
view_label: "Period Over Period"
type: string
sql:
     CASE
         WHEN ${date} >= ${first_date_in_period}
         THEN 'This {% parameter period %} to date'
         WHEN ${date} >= ${first_date_in_prior_period}
         AND ${date} <= ${last_date_in_prior_period}
         THEN 'Prior {% parameter period %} to date'
         ELSE NULL
         END;;
}

dimension: days_from_period_start {
view_label: "Period Over Period"
type: number
sql: CASE WHEN ${period_selected} = 'This {% parameter period %} to date'
THEN DATE_DIFF ${date}, ${first_date_in_period}, DAY)
WHEN ${period_selected}= 'Prior {% parameter period %} to date'
THEN DATE_DIFF(${date}, ${first_date_in_prior_period}, DAY)
ELSE NULL
END;;
}
  measure: sum_of_sales {
  type: sum
  sql: ${sales} ;;
  }

  set: detail {
    fields: [date, sales]
  }
}
